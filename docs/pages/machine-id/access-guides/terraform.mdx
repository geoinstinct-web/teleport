---
title: Machine ID with the Teleport Terraform Provider
description: How to use Machine ID with the Teleport Terraform provider to manage your Teleport configuration as IaC
---

In this guide, you will configure `tbot` to produce credentials for the Teleport
Terraform Provider.

## Before you start

(!docs/pages/includes/edition-prereqs-tabs.mdx!)
- `tbot` must be configured and installed on your platform. Follow a
  [platform guide](../platform-guides.mdx) to do so.

## Step 1/3. Configure RBAC

Use `tctl edit role/example-bot` to add the following rule to the role:

```yaml
spec:
  allow:
    rules:
    - resources:
      # Specify the names of resources you wish to manage with Terraform.
      # For this guide, we will only manage roles.
      - role
      verbs:
      - create
      - read
      - update
      - delete
      - list
```

## Step 2/3. Configure `tbot` output

```yaml
outputs:
- type: identity
  destination:
    type: directory
    path: /opt/machine-id
```

## Step 3/3. Use Terraform with the identity output

```hcl
terraform {
  required_providers {
    teleport = {
      version = "(=teleport.version=)"
      source  = "terraform.releases.teleport.dev/gravitational/teleport"
    }
  }
}

provider "teleport" {
  # Replace with the address of your Teleport Proxy or Auth Server.
  addr               = "teleport.example.com:443"
  # Replace with the directory configured in the identity output in the
  # previous step.
  identity_file_path = "/opt/machine-id/identity"
}

# This is an example. Replace this with the resource you wish to be managed
# with Terraform. See the following reference for supported options:
# https://goteleport.com/docs/reference/terraform-provider/
resource "teleport_role" "terraform-test" {
  metadata = {
    name        = "terraform-test"
    description = "Example role created by Terraform"
  }

  spec = {
    allow = {
      logins = ["root"]
      node_labels = {
        key    = ["value"]
      }
    }
  }
}
```

## Next steps

- Explore the
  [Terraform provider resource reference](https://goteleport.com/docs/reference/terraform-provider/)
  to discover what can be configured with Terraform.