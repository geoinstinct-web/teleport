---
title: Deploying Machine ID on Linux
description: How to install and configure Machine ID on a Linux host
---

This page contains relevant background information and specific steps for
deploying Machine ID on a Linux host.

## Background

### The `token` join method

TODO: Brief overview of how the join method works for this platform.

## Guide

In this guide, you will install Machine ID's agent, `tbot` on a Linux host.

### Prerequisites

(!docs/pages/includes/edition-prereqs-tabs.mdx!)

- (!docs/pages/includes/tctl.mdx!)
- A Linux host that you wish to install Machine ID onto.
- A Linux user on that host that you wish Machine ID to run as. In the guide,
  we will use `teleport` for this.

### Step 1/4. Install `tbot`

Download the appropriate Teleport package for your platform:

(!docs/pages/includes/install-linux.mdx!)

### Step 2/4. Create a role and bot user

(!docs/pages/includes/machine-id/blank-role.mdx!)

Create the bot, specifying the role that you have created:

```code
$ tctl bots add example --roles example-bot
```

A join token will be included in the results of `tctl bots add`, record this
value as it will be needed when configuring `tbot`.

### Step 3/4. Configure `tbot`

First, prepare the directory that `tbot` will use to persist its state. This
directory should only be readable and writable by the Linux user that `tbot`
will run as. Execute the following, replacing `teleport` with the Linux user
that you will run `tbot` as:

```code
# Make the bot directory and assign ownership to teleport user
$ sudo mkdir -p /var/lib/teleport/bot
$ sudo chown teleport:teleport /var/lib/teleport/bot
```

Next, the token that was generated when the bot was created using `tctl` must
be written to disk. As this token is sensitive, we want to ensure that this
can only be read by `tbot`. Execute the following, replacing `teleport` with the
Linux user that you will run `tbot` as and `(=presets.tokens.first=)` with the
token returned by `tctl bots add`:

```code
# Write the token you received when running `tctl bots add` to a file
$ echo "(=presets.tokens.first=)" | sudo tee /var/lib/teleport/bot/token
# Set the file permissions so it can only be accessed by its owner
$ sudo chmod 700 /var/lib/teleport/bot/token
# Set the owner of the file to the Linux user that `tbot` will run as:
$ sudo chown teleport:teleport /var/lib/teleport/bot/token
```

Create `/etc/tbot.yaml`:

```yaml
version: v2
# ensure this is configured to the address of your Teleport Proxy or
# Auth Server. Prefer the address of the Teleport Proxy.
auth_server: example.teleport.sh:443
onboarding:
  join_method: token
  token: /var/lib/teleport/bot/token
storage:
  type: directory
  path: /var/lib/teleport/bot
outputs: []
```

(!docs/pages/includes/machine-id/daemon.mdx!)

### Step 4/4. Configure Outputs

Follow one of the [access guides](../access-guides.mdx) to configure an output
that meets your access needs.

## Next steps

- Follow the [access guides](../access-guides.mdx) to finish configuring `tbot` for
  your environment.
- Read the [configuration reference](../reference/configuration.mdx) to explore
  all the available configuration options.