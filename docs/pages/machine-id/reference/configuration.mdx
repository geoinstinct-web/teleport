---
title: Machine ID Configuration Reference
description: Configuration reference for Teleport Machine ID.
---

The following snippet shows full YAML configuration of the Machine ID client
`tbot`. Assuming the file is written to `tbot.yaml`, it can be used with
`tbot -c /etc/tbot.yaml`.

```yaml
# Version specifies the version of the configuration file in use. `v2` is the
# most recent and should be used for all new bots.
version: v2

# Debug enables verbose logging to stderr.
debug: true

# Address of the Teleport Proxy (on-prem installs) or Teleport Cloud tenant.
auth_server: "teleport.example.com:443" # or "example.teleport.sh:443" for Teleport Cloud

# TTL of short-lived machine certificates.
certificate_ttl: "1h"

# Interval at which short-lived certificates are renewed; must be less than
# the certificate TTL.
renewal_interval: "20m"

# If set, quit after the first renewal.
oneshot: true

# The onboarding configuration specifies how the bot should authenticate with
# the Teleport cluster on first join, and in the case of delegated join methods,
# on each renewal.
onboarding:
    # The method the bot should use to join the cluster. This can be:
    # - token
    # - circleci
    # - github
    # - gitlab
    # - iam
    join_method: "token"

    # The name of the token to use when joining the cluster.
    #
    # This can also be an absolute path to a file containing the token.
    # The token can live in a temporary file that's deleted after tbot is first launched, 
    # but if tbot has to re-authenticate with the Auth Service, it will fail.
    # 
    # File path example:
    # token: /var/lib/teleport/tokenjoin
    token: "00000000000000000000000000000000"

    # CA Path used to validate the identity of the Teleport Auth Server on first connect.
    # This value is not used when connecting to a proxy.
    ca_path: "/path/to/ca.pem"

    # CA Pins used to validate the identity of the Teleport Auth Server on first connect.
    # This value is not used when connecting to a proxy.
    ca_pins:
        - "(=presets.ca_pin=)"
        - "(=presets.ca_pin=)"


storage:
    type: directory
    # Directory to store internal bot data. Access to this directory should be
    # limited. By default, this value is `/var/lib/teleport/bot`.
    path: /var/lib/teleport/bot

# Outputs specify the credentials that `tbot` should generate.
outputs:
  - type: identity
    destination:
      type: directory
      path: /opt/machine-id
```

If no configuration file is provided, a simple configuration is used based
entirely on provided CLI flags. Given the following sample CLI from
`tctl bots add ...`:

```code
$ tbot start \
   --destination-dir=./tbot-user \
   --token=00000000000000000000000000000000 \
   --ca-pin=(=presets.ca_pin=) \
   --auth-server=auth.example.com:3025
```

... it uses a configuration equivalent to the following:

```yaml
auth_server: auth.example.com:3025

onboarding:
  join_method: "token"
  token: "(=presets.tokens.first=)"
  ca_pins:
      - "(=presets.ca_pin=)"

storage:
  type: directory
  path: /var/lib/teleport/bot

outputs:
  - type: identity
    destination:
      type: directory
      path: ./tbot-user
```

## Outputs

Outputs define what actions `tbot` should take when it runs. They describe
what format of credentials should be generated, with what roles and to what
destination they should be written.

There are multiple types of output, select the one that is most appropriate for
your intended use-case.

### `identity`

```yaml
# For an identity output, type will always be `identity`.
type: identity
destination:
  type: directory
  path: /opt/machine-id
roles:
  - editor
```

### `application`

```yaml
type: application
destination:
  type: directory
  path: /opt/machine-id
roles:
  - editor
```

### `database`

```yaml
type: database
destination:
  type: directory
  path: /opt/machine-id
roles:
  - editor
```

### `kubernetes`

```yaml
type: kubernetes
destination:
  type: directory
  path: /opt/machine-id
roles:
  - editor
```

### `ssh_host`

```yaml
type: ssh_host
destination:
  type: directory
  path: /opt/machine-id
roles:
  - editor
```

## Destinations

A destination is somewhere that `tbot` can read and write artifacts.

Destinations are used in two places in the `tbot` configuration:

- Specifying where `tbot` should store its internal state
- Specifying where an output should write the generated artifacts to

Destinations come in multiple types, usually the `directory` type will be most
appropriate.

### `directory`

The `directory` destination type stores artifacts as files within a specified
directory. This is usually the correct destination type to use.

```yaml
# For a directory destination, type will always be `directory`.
type: directory

# The path to the folder in which to read and write files.
path: /opt/machine-id

# Configure symlink attack prevention. Requires Linux 5.6+.
# Possible values:
#   * try-secure (default): Attempt to securely read and write certificates
#     without symlinks, but fall back (with a warning) to insecure read
#     and write if the host doesn't support this.
#   * secure: Attempt to securely read and write certificates, with a hard error
#     if unsupported.
#   * insecure: Quietly allow symlinks in paths.
symlinks: try-secure
# Configure ACL use. Requires Linux with a file system that supports ACLs.
# Possible values:
#   * try (default on Linux): Attempt to use ACLs, warn at runtime if ACLs
#     are configured but invalid.
#   * off (default on non-Linux): Do not attempt to use ACLs.
#   * required: Always use ACLs, produce a hard error at runtime if ACLs
#     are invalid.
acls: try
```

### `memory`

The `memory` destination type stores artifacts within the process memory. This
means when the process exits, nothing will be persisted. This destination type
is most suitable for ephemeral environments, but can also be used for testing.

Configuration:

```yaml
# For a memory destination, type will always be `memory`.
type: memory
```