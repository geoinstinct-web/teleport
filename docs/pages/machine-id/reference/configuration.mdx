---
title: Machine ID Configuration Reference
description: Configuration reference for Teleport Machine ID.
---

The following snippet shows full YAML configuration of the Machine ID client
`tbot`. Assuming the file is written to `tbot.yaml`, it can be used with
`tbot -c /etc/tbot.yaml`.

```yaml
# `version` specifies the version of the configuration file in use. `v2` is the
# most recent and should be used for all new bots. The rest of this example
# is in the `v2` schema.
version: v2

# `debug` enables verbose logging to stderr. If unspecified, this defaults to
# false.
debug: true

# `auth_server `specifies the Proxy or Auth Server that `tbot` should connect
# to. It is recommended to use the address of your Teleport Proxy, or, if using
# Teleport Cloud, the address of your Teleport Cloud instance.
auth_server: "teleport.example.com:443" # or "example.teleport.sh:443" for Teleport Cloud

# certificate_ttl specifies how long certificates generated by `tbot` should
# live for. It should be a positive, numeric value with an `m` (for minutes) or
# `h` (for hours) suffix. By default, this value is `1h`.
certificate_ttl: "1h"

# `renewal_interval` specifies how often `tbot` should aim to renew the
# outputs it has generated. It should be a positive, numeric value with an
# `m` (for minutes) or `h` (for hours) suffix. The default value is `20m`.
# This value must be lower than `certificate_ttl`.
# This value is ignored when using `tbot` is running in one-shot mode.
renewal_interval: "20m"

# `oneshot` is an option that when set to true, configures `tbot` to exit
# immediately after generating the outputs.  The default value is `false`.
# This is useful in ephemeral
# environments, like CI/CD.
oneshot: false

# `onboarding` is a group of configuration options that control how `tbot` will
# authenticate with the Teleport cluster.
onboarding:
    # `token` specifies which join token, configured in the Teleport cluster,
    # should be used to join the Teleport cluster.
    #
    # This can also be an absolute path to a file containing the token name.
    # File path example:
    # token: /var/lib/teleport/tokenjoin
    #
    # When using the `token` join method, we recommend use the file path
    # invocation, as the file containing the token can be deleted after the
    # bot has initially registered.
    token: "00000000000000000000000000000000"

    # `join_method` specifies the join method associated with the token
    # specified above. This should match the value configured in the `token`
    # resource you have created before starting the bot.
    #
    # Support values include:
    # - `token`
    # - `azure`
    # - `circleci`
    # - `github`
    # - `gitlab`
    # - `iam`
    join_method: "token"

    # `ca_pins` is used to validate the identity of the Teleport Auth Server on
    # first connect. This should not be specified when using Teleport Cloud or
    # connecting via a Teleport Proxy.
    ca_pins:
      - "(=presets.ca_pin=)"
      - "(=presets.ca_pin=)"

    # `ca_path` is used to validate the identity of the Teleport Auth Server on
    # first connect. This should not be specified when using Teleport Cloud or
    # connecting via a Teleport Proxy.
    ca_path: "/path/to/ca.pem"

# `storage` specifies the destination that `tbot` should use to store its
# internal state. This state is sensitive, and you should ensure that the
# destination you specify here can only be accessed by `tbot`.
#
# If unspecified, storage will be set to a directory destination with a path
# of `/var/lib/teleport/bot`.
#
# See the full list of supported destinations and their configuration options
# under the Destinations section of this reference page.
storage:
  type: directory
  path: /var/lib/teleport/bot

# `outputs` specifies what `tbot` should generate and renew when it runs.
#
# See the full list of supported outputs and their configuration options
# under the Outputs section of this reference page.
outputs:
  - type: identity
    destination:
      type: directory
      path: /opt/machine-id
```

If no configuration file is provided, a simple configuration is used based
on the provided CLI flags. Given the following sample CLI from
`tctl bots add ...`:

```code
$ tbot start \
   --destination-dir=./tbot-user \
   --token=00000000000000000000000000000000 \
   --ca-pin=(=presets.ca_pin=) \
   --auth-server=auth.example.com:3025
```

it uses a configuration equivalent to the following:

```yaml
auth_server: auth.example.com:3025

onboarding:
  join_method: "token"
  token: "(=presets.tokens.first=)"
  ca_pins:
      - "(=presets.ca_pin=)"

storage:
  type: directory
  path: /var/lib/teleport/bot

outputs:
  - type: identity
    destination:
      type: directory
      path: ./tbot-user
```

## Outputs

Outputs define what actions `tbot` should take when it runs. They describe
what format of credentials should be generated, with what roles and to what
destination they should be written.

There are multiple types of output, select the one that is most appropriate for
your intended use-case.

### `identity`

```yaml
# For an identity output, type will always be `identity`.
type: identity
destination:
  type: directory
  path: /opt/machine-id
roles:
  - editor
```

### `application`

```yaml
type: application
destination:
  type: directory
  path: /opt/machine-id
roles:
  - editor
```

### `database`

```yaml
type: database
destination:
  type: directory
  path: /opt/machine-id
roles:
  - editor
```

### `kubernetes`

```yaml
type: kubernetes
destination:
  type: directory
  path: /opt/machine-id
roles:
  - editor
```

### `ssh_host`

```yaml
type: ssh_host
destination:
  type: directory
  path: /opt/machine-id
roles:
  - editor
```

## Destinations

A destination is somewhere that `tbot` can read and write artifacts.

Destinations are used in two places in the `tbot` configuration:

- Specifying where `tbot` should store its internal state
- Specifying where an output should write the generated artifacts to

Destinations come in multiple types, usually the `directory` type will be most
appropriate.

### `directory`

The `directory` destination type stores artifacts as files within a specified
directory. This is usually the correct destination type to use.

```yaml
# For a directory destination, type will always be `directory`.
type: directory

# The path to the folder in which to read and write files.
path: /opt/machine-id

# Configure symlink attack prevention. Requires Linux 5.6+.
# Possible values:
#   * try-secure (default): Attempt to securely read and write certificates
#     without symlinks, but fall back (with a warning) to insecure read
#     and write if the host doesn't support this.
#   * secure: Attempt to securely read and write certificates, with a hard error
#     if unsupported.
#   * insecure: Quietly allow symlinks in paths.
symlinks: try-secure
# Configure ACL use. Requires Linux with a file system that supports ACLs.
# Possible values:
#   * try (default on Linux): Attempt to use ACLs, warn at runtime if ACLs
#     are configured but invalid.
#   * off (default on non-Linux): Do not attempt to use ACLs.
#   * required: Always use ACLs, produce a hard error at runtime if ACLs
#     are invalid.
acls: try
```

### `memory`

The `memory` destination type stores artifacts within the process memory. This
means when the process exits, nothing will be persisted. This destination type
is most suitable for ephemeral environments, but can also be used for testing.

Configuration:

```yaml
# For a memory destination, type will always be `memory`.
type: memory
```