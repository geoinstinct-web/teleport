---
title: Running Teleport with Self-Signed Certs
description: How run Teleport using self-certs
---

In this guide, we will show you how to run Teleport with self-signed certs, with remedies for problems caused
by using self-signed certs.

The Teleport Proxy Service authenticates itself to clients via TLS x509 certificates.
If certificates are not configured for the Proxy Service, then it uses self-signed certificates,
which clients will not trust by default. This can cause problems when using tools like
`teleport`, `tsh`, or `tctl`.

Additionally, when visiting the cluster's web portal, the certificate presented will not be trusted by your browser. In this case, you will likely see a page warning you that the site is not trusted.

<Notice type="warning" title="DO NOT USE THIS IN PRODUCTION">
  **DO NOT USE SELF-SIGNED CERTS IN PRODUCTION**

  It is not recommended to run Teleport in production with self-signed certificates.
  It is important to [properly configure certificates](#configuring-certificates-properly) from a trusted
  [Certificate Authority](https://goteleport.com/blog/ssh-certificate-authorities-explained/)
  to prevent a [Man-In-The-Middle (MITM)](https://en.wikipedia.org/wiki/Man-in-the-middle_attack) attack.

  This guide is provided for the benefit of users who are interested in evaluating Teleport in a
  non-production environment, without having to configure certificates.
</Notice>

## Prerequisites

(!docs/pages/includes/edition-prereqs-tabs.mdx!)

## Self-Signed Certs: `teleport`

When running a Teleport service with `teleport`, if the service you are starting is configured to point to
the Teleport Proxy Service endpoint and the proxy service is using self-signed certs, then `teleport` will need
to be run with the `--insecure` flag to disable verification of the
proxy's TLS certificate. This is the case when:
- The Teleport config file `auth_servers` setting is set to the proxy endpoint:
  - `auth_servers: ["tele.example.com:443"]` or
  - `auth_servers: ["tele.example.com:3080"]`
- Teleport is started with the `--auth-server` flag pointing to the proxy endpoint:
  - `teleport [app | db] start --auth-server=tele.example.com:443` or
  - `teleport [app | db] start --auth-server=tele.example.com:3080`

The way you make your Teleport service run with TLS certificate verification disabled depends on how you are
running it - via `teleport` directly from the cli, or via helm chart, or via systemd:
<Tabs>

    <TabItem label="Running teleport directly">
    When running `teleport` from the command line, pass the `--insecure` flag to disable
    TLS certificate validation. For example:
    ```sh
    $ teleport start -c /etc/teleport.yaml --insecure
    $ teleport app start -c /etc/teleport.yaml --insecure
    $ teleport db start -c /etc/teleport.yaml --insecure
    ```
    Without the `--insecure` flag, you will see an error message that looks like
    `x509: “tele.example.com” certificate is not trusted`.
    </TabItem>

    <TabItem label="Running teleport via helm chart">
    For deploying a cluster, set
    [extraArgs](../../reference/helm-reference/teleport-cluster.mdx#extraargs)
    to include the extra argument: `--insecure`.
    
    
    For a Helm Kube Agent, set the 
    [insecureSkipProxyTLSVerify
    ](../../reference/helm-reference/teleport-kube-agent.mdx#insecureskipproxytlsverify)
    flag to `true`.
    </TabItem>

    <TabItem label="Running teleport via systemd">
    Edit the `systemd` Teleport unit file to include `--insecure` in the `ExecStart` line, for example:
    
    `ExecStart=/usr/local/bin/teleport start --pid-file=/run/teleport.pid --insecure`
    
    You also need to run `sudo systemctl daemon-reload` and then `sudo systemctl restart teleport.service`
    for your change to take effect.
    
    See [create a systemd service](./daemon.mdx#step-23-create-and-configure-a-systemd-service) for
    more information.
    </TabItem>

</Tabs>

## Self-Signed Certs: `tctl`
When running `tctl` remotely via the Teleport Proxy Service, if the proxy is using self-signed certs,
then `tctl` will not trust the certificate from the proxy. To disable certificate verification use
`tctl --insecure`.
`tctl` will determine how to connect to the auth service in a few ways:
- loading configuration from the profile after logging in with `tsh`
- loading from a config file passed as an argument: `tctl -c /etc/teleport.yaml`
- passing the `--auth-server` flag directly, as in:
  - `tctl --auth-server=tele.example.com:443` or
  - `tctl --auth-server=tele.example.com:3080`

If any of these methods tries to connect via the Teleport Proxy Service, and the proxy is using self-signed
certs, then `tctl` will not trust the certificate from the proxy and you will get an error message about
untrusted or invalid certificates, unless `--insecure` is also passed to `tctl`.

## Self-Signed Certs: `tsh`
When running `tsh`, you must specify the Teleport Proxy Service address for `tsh` to connect to.
If the Teleport Proxy Service is using self-signed certs, then `tsh` will not trust the proxy's certificate.
In order to use `tsh` in this case, you need to use the `--insecure` flag.

## Configuring Certificates Properly

Now that you have learned how to use Teleport with self-signed certificates, you may be interested in how to do 
things *the right way*.

(!docs/pages/includes/tls-certificate-setup.mdx!)

## Further reading

- [Teleport Proxy](../../architecture/proxy.mdx)
- [Teleport Authentication](../../architecture/authentication.mdx)
