---
title: Getting Started with Teleport Application Access
description: Getting started with Teleport application access.
videoBanner: 5Uwhp3IQMHY
---

This tutorial demonstrates how to configure secure access to an application through Teleport. 
The tutorial uses Grafana as a sample application because it's straightforward to install and run 
in a Docker container or Kubernetes cluster with no additional configuration required.
If you want to configure access for a different web application, you can use this tutorial as a 
general guide for what to do. 

At a high level, configuring access for applications involves the following steps:

* Verify your environment meets the prerequisites.
* Verify you can launch the application in a Docker container, Kubernetes cluster, or using another method.
* Generate a short-lived token for the application.
* Install and configure on the application host.
* Add a user to verify access to the application.

If you have not yet deployed the Auth Service and Proxy Service, see one of the [getting started guides](../get-started.mdx) or try the
Teleport Application Access [interactive learning track](https://play.instruqt.com/teleport/invite/rgvuva4gzkon).

The following diagram illustrates the basic steps for connecting to Grafana using Teleport.

<ScopedBlock scope={["oss", "enterprise"]}>
![Teleport Application Access Grafana Self-Hosted](../../img/application-access/grafana_selfhosted.png)
</ScopedBlock>
<ScopedBlock scope={["cloud"]}>
![Teleport Application Access Grafana Cloud](../../img/application-access/grafana_cloud.png)
</ScopedBlock>

## Prerequisites

(!docs/pages/includes/edition-prereqs-tabs.mdx!)

- (!docs/pages/includes/tctl.mdx!)
- A host where you will run the Teleport Application Service.
- A DNS subdomain for each application.
   
   <Admonition type="note" title="Application Access and DNS for Self-Hosted Clusters">

   (!docs/pages/includes/dns-app-access.mdx!)

   Teleport Cloud will automatically provide a subdomain and signed TLS certificate for your application under your tenant address.
   </Admonition>

- Docker or Kubernetes to launch Grafana.

   This tutorial illustrates how to launch Grafana in a Docker container or Kubernetes cluster.
   Therefore, you must have either Docker or Kubernetes installed. For more information, click **Docker** or **Kubernetes cluster**.
   
   <Tabs>
   <TabItem label="Docker">
   You must have some version of Docker installed to launch Grafana in a Docker container. 
   If you are configuring access to a different web application using Teleport, use the appropriate commands to 
   launch that application in a Docker container.
   </TabItem>
   <TabItem label="Kubernetes cluster">

<<<<<<< HEAD
<Admonition type="tip" title="Not yet a Teleport user?">
{/*lint ignore messaging*/}
If you have not yet deployed the Auth Service and Proxy Service, you should
follow one of our [getting started guides](../get-started.mdx) or try our
Teleport Application Access [interactive learning track](https://play.instruqt.com/teleport/invite/rgvuva4gzkon).
</Admonition>
=======
   (!docs/pages/includes/kubernetes-access/helm-k8s.mdx!)
>>>>>>> 2cc8309e9a (First pass at simplifying this page, removing redundant steps and making editorial suggestions for the content)

   - Administrative rights to deploy within a cluster.

   </TabItem>
   </Tabs>

- Check that you are using appropriate permissions.
   The permissions used in examples in this tutorial are intended for demo environments.
   Before running Teleport in a production environment, check that you are following best practices to avoid security incidents.

   (!docs/pages/includes/permission-warning.mdx!)

## Step 1/5. Generate a token

A join token is required to authorize a Teleport Application Service instance to
join the cluster. Generate a short-lived join token and save it, for example,
in `/tmp/token`:

```code
$ tctl tokens add \
    --type=app \
    --app-name=grafana \
    --app-uri=http://localhost:3000
```

## Step 2/5. Start Grafana

You can start Grafana in a Docker container or Kubernetes cluster by running the appropriate steps.
For more information, click **Docker** or **Kubernetes cluster**.

<Tabs>
<TabItem label="Docker">

You can start Grafana in a Docker container by running the following command:

```code
$ docker run -d --name grafana -p 3000:3000 grafana/grafana
```

After running this command, edit the `/etc/grafana/grafana.ini` file in the container. 
Under `[server]`, uncomment the `domain` key and set the value to your Teleport
cluster domain, (for example, `teleport.example.com`). 
Because the container doesn't have a text editor installed, you can use the `sed` command to edit the file. 
For example:

```code
$ docker exec -u 0 grafana sed -i 's/;domain = localhost/domain = teleport.example.com/g' /etc/grafana/grafana.ini
```

Replace `teleport.example.com` with your Teleport cluster domain.
</TabItem>
<TabItem label="Kubernetes cluster">

If you install Grafana with the following `helm` instructions, it is available at `http://example-grafana.example-grafana.svc.cluster.local`
within the Kubernetes cluster.

```code
$ helm repo add grafana https://grafana.github.io/helm-charts
$ helm repo update
$ helm install example-grafana grafana/grafana \
    --create-namespace \
    --namespace example-grafana
```
</TabItem>
</Tabs>

## Step 3/5. Install and configure Teleport

Install Teleport on the host where you will run the Teleport Application Service.

<Tabs>
<TabItem label="Docker">
See the [Installation](../installation.mdx) page for options besides Linux servers.

(!docs/pages/includes/install-linux.mdx!)

Create the Teleport Application Service configuration at `/etc/teleport.yaml`.
Replace <Var name="teleport.example.com" /> with your Teleport Proxy Service
address or Teleport Cloud tenant (for example, `mytenant.teleport.sh`).

```code
$ sudo teleport configure \
  -o file \
  --proxy=<Var name="teleport.example.com" />:443 \
  --token=/tmp/token \
  --roles=app \
  --app-name=grafana \
  --app-uri=http://localhost:3000
```
  
Make sure to update `--app-name` and `--app-uri` accordingly if you're using your
own web application.

The `--token` flag points to the file on the Application Service host where you
stored the token that you generated earlier.

(!docs/pages/includes/start-teleport.mdx service="the Teleport Application Service"!)
</TabItem>
<TabItem label="Kubernetes cluster">

(!docs/pages/kubernetes-access/helm/includes/helm-repo-add.mdx!)

<ScopedBlock scope={["oss", "enterprise"]}>
Install the Teleport Kubernetes Service into your Kubernetes cluster
with the Teleport Application Service configuration.
Replace <Var name="teleport.example.com" /> with
your Teleport Proxy Service address or your
Teleport Enterprise Cloud tenant (for example, `mytenant.teleport.sh`):

```code
$ JOIN_TOKEN=$(cat /tmp/token)
$ helm install teleport-kube-agent teleport/teleport-kube-agent \
  --create-namespace \
  --namespace teleport-agent \
  --set roles=app \
  --set proxyAddr=<Var name="teleport.example.com" />:443 \
  --set authToken=${JOIN_TOKEN?} \
  --set "apps[0].name=grafana" \
  --set "apps[0].uri=http://example-grafana.example-grafana.svc.cluster.local" \
  --set "labels.env=dev" \
  --version (=teleport.version=)
```

</ScopedBlock>
<ScopedBlock scope={["cloud"]}>
Install the Teleport Kubernetes Service into your Kubernetes Cluster
with the Teleport Application Service configuration.
Replace <Var name="teleport.example.com" /> with
your Teleport Enterprise Cloud tenant address (`mytenant.teleport.sh`)
```code
$ JOIN_TOKEN=$(cat /tmp/token)
$ helm install teleport-kube-agent teleport/teleport-kube-agent \
  --create-namespace \
  --namespace teleport-agent \
  --set roles=app \
  --set proxyAddr=<Var name="teleport.example.com" />:443 \
  --set authToken=${JOIN_TOKEN?} \
  --set "apps[0].name=grafana" \
  --set "apps[0].uri=http://example-grafana.example-grafana.svc.cluster.local" \
  --set "labels.env=dev" \
  --version (=cloud.version=)
```
</ScopedBlock>

Make sure to update `apps[0].name` and `apps[0].uri` accordingly if you're using
your own web application.

</TabItem>
</Tabs>

## Step 4/5. Create a user

Next, let's create a user to access the application we've just connected.
Teleport has a built-in role called `access` that allows users to access
cluster resources. Create a local user assigned this role:

```code
$ tctl users add --roles=access alice
```

The command will output a signup link. Use it to choose a password and set up a
second factor. After that, it will take you to the Teleport Web UI.

## Step 5/5. Access the application

There are a couple of ways to access the proxied application.

Log in to the Teleport Web UI at your Proxy Service address. 
All available applications are displayed on the Applications tab. 
Click Launch on the Grafana application tile to access it.

Alternatively call the application directly with its name as the subdomain, for example, 
`https://grafana.teleport.example.com` or `https://grafana.mytenant.teleport.sh`
for a Teleport Cloud tenant. 
You are prompted to log in if you haven't already been authenticated.

## Next steps
<<<<<<< HEAD
{/*lint ignore messaging*/}
Dive deeper into the topics relevant to your Application Access use-case:
=======

Learn more about protecting applications with Teleport in the following topics:
>>>>>>> 2cc8309e9a (First pass at simplifying this page, removing redundant steps and making editorial suggestions for the content)

- [Connecting applications](./guides/connecting-apps.mdx).
- Integrating with [JWT tokens](./jwt/introduction.mdx).
- Accessing applications with [RESTful APIs](./guides/api-access.mdx).
- Setting configuration options AND running CLI commands in the [Application Access reference](./reference.mdx).
- Using the Let's Encrypt [ACME protocol](https://letsencrypt.org/how-it-works/).
